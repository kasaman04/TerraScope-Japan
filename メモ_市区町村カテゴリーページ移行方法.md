# 〇〇市モーダルから、カテゴリーページ移行方法

## URLパターンルール
**基本構造：**
```
/ja/blog/{県名}/{市名}/
```

**具体例：**
- 北海道札幌市: `/ja/blog/hokkaido/sapporo/`
- 北海道函館市: `/ja/blog/hokkaido/hakodate/`
- 東京都渋谷区: `/ja/blog/tokyo/shibuya/`
- 大阪府大阪市: `/ja/blog/osaka/osaka/`
- 京都府京都市: `/ja/blog/kyoto/kyoto/`
- 神奈川県横浜市: `/ja/blog/kanagawa/yokohama/`

## ユーザーフロー
1. **都道府県ページにアクセス** (例: `/ja/blog/hokkaido/`)
2. **市区町村カードをクリック** → モーダルが開く
3. **「📖 詳しい記事を見る」をクリック** → `pageUrl`で指定されたURLに遷移
4. **市区町村専用カテゴリーページが表示** → 8カテゴリーの生活情報

## 実装要件

### ファイル配置
```
/src/pages/ja/blog/{県名}/{市名}/index.astro
```

### BaseLayout import パス
```astro
import BaseLayout from '../../../../../layouts/BaseLayout.astro';
```
※ 深度6（blog/県名/市名からlayoutsまで）

### カテゴリー構成（8カテゴリー）
1. 🗾 地域情報
2. 🚃 アクセス  
3. 🏪 生活利便性
4. 🌏 国際対応
5. 👨‍👩‍👧‍👦 子育て・教育
6. 💰 コスト
7. 🛡️ 安全性
8. 🚀 将来性

### 画像パス
```astro
src={`${import.meta.env.BASE_URL}assets/images/prefectures/{都道府県名}.png`}
```

### URL構造
- 全リンクに `/ja/blog/{県名}/` プレフィックスを使用
- 「もっと見る」ボタン： `/ja/blog/{県名}/{カテゴリー名}/`

## 現状
- **実装済み**: 北海道全9市 (`札幌、函館、小樽、旭川、帯広、苫小牧、岩見沢、室蘭、釧路`)
- **未実装**: 約300の市区町村（全てのモーダルリンクが404エラー）

## テンプレート例（札幌市ベース）

### 基本構造（完全版）
```astro
---
import BaseLayout from '../../../../../layouts/BaseLayout.astro';

const title = "{市名} 記事カテゴリー一覧";
const description = "{市名}の外国人向け生活情報カテゴリー一覧";
const lang = "ja";

// 人気記事ランキング（市名に合わせてカスタマイズ）
const popularArticles = [
  {
    title: "{市名}の雪対策と冬の生活",  // 市名を入れて地域特性を反映
    category: "生活利便性",
    url: "/ja/blog/{県名}/living-convenience-article-1/"
  },
  {
    title: "新千歳空港からのアクセス",  // 主要空港や交通の記載
    category: "アクセス", 
    url: "/ja/blog/{県名}/access-article-1/"
  },
  {
    title: "{市名}の住宅事情：家賃・光熱費",  // 市名を入れてローカライズ
    category: "コスト",
    url: "/ja/blog/{県名}/cost-article-1/"
  }
];
---

<BaseLayout {title} {description} {lang}>
  <div class="min-h-screen bg-gray-50 py-8">
    <div class="max-w-6xl mx-auto px-4">
      
      <!-- Breadcrumb（必須） -->
      <nav class="mb-8">
        <ol class="flex items-center space-x-2 text-sm text-gray-600">
          <li><a href={`${import.meta.env.BASE_URL}ja/`} class="hover:text-blue-600">ホーム</a></li>
          <li><span class="mx-2">/</span></li>
          <li><a href={`${import.meta.env.BASE_URL}ja/blog/`} class="hover:text-blue-600">地域別生活情報</a></li>
          <li><span class="mx-2">/</span></li>
          <li><a href={`${import.meta.env.BASE_URL}ja/blog/{県名}/`} class="hover:text-blue-600">{都道府県名}</a></li>
          <li><span class="mx-2">/</span></li>
          <li class="text-gray-900 font-medium">{市名}</li>
        </ol>
      </nav>
      
      <!-- Page Header -->
      <div class="text-center mb-12">
        <h1 class="text-2xl font-bold text-gray-900 mb-2">{市名}の<span class="text-red-500">生活情報</span></h1>
        <p class="text-sm text-gray-600">外国人向けの生活情報をカテゴリー別にまとめました</p>
      </div>

      <!-- Main Content Layout -->
      <div class="lg:grid lg:grid-cols-4 lg:gap-8">
        
        <!-- Categories List (Main Content) -->
        <div class="lg:col-span-3 space-y-12">
          <!-- 8カテゴリーのセクション -->
          <!-- ... -->
        </div>

        <!-- Popular Articles Sidebar (Desktop) -->
        <div class="hidden lg:block lg:col-span-1">
          <div class="sticky top-8">
            <div class="bg-white rounded-lg shadow-　sm border border-gray-200 p-4">
              <div class="mb-4">
                <h2 class="text-gray-900 text-lg font-bold">人気の記事</h2>
              </div>
              
              <div class="space-y-0">
                {popularArticles.map((article, index) => (
                  <a href={article.url} class="block group">
                    <div class="flex items-start space-x-2 py-3 hover:bg-gray-50 transition-colors border-b border-gray-200">
                      <div class="flex-shrink-0">
                        <img 
                          src={`${import.meta.env.BASE_URL}assets/images/prefectures/{県名}.png`}
                          alt={article.title}
                          class="w-18 h-12 object-cover rounded"
                          loading="lazy"
                        />
                      </div>
                      <div class="flex-1 min-w-0">
                        <h3 class="text-gray-900 font-medium text-xs leading-tight line-clamp-2 mb-2 group-hover:text-blue-600 transition-colors">
                          {article.title}
                        </h3>
                        <div class="text-gray-600 text-xs">
                          {article.category}
                        </div>
                      </div>
                    </div>
                  </a>
                ))}
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</BaseLayout>
```

## 実装の進め方

### 優先順位
1. **主要都市**：東京（新宿、渋谷）、大阪、名古屋、福岡など
2. **県庁所在地**：各都道府県の中心都市
3. **その他市区町村**：順次展開

### 効率化のポイント
- 札幌市ページをテンプレートとして活用
- 市区町村の特色に合わせてコンテンツをカスタマイズ
- BaseLayoutのimportパスに注意（深度6）
- 画像パスは都道府県名を使用

## 重要な実装注意点

### 必須要素（絶対に含める）
1. **パンくずリスト**: ナビゲーション改善のため必須
2. **人気記事セクション**: デスクトップ（サイドバー）とモバイル（下部）の両方
3. **8カテゴリー**: 地域情報、アクセス、生活利便性、国際対応、子育て・教育、コスト、安全性、将来性

### 絶対に追加してはいけない要素
- **「最新情報をお届け」セクション**: 不要
- **ニュースレター登録フォーム**: 不要  
- **購読ボタン**: 不要
- **その他の余計なセクション**: 札幌市ページにないものは追加しない

### 人気記事の設定ルール
```javascript
// 各市に合わせて以下のパターンで設定：
const popularArticles = [
  {
    title: "{市名}の雪対策と冬の生活",  // 地域特性を反映
    category: "生活利便性",
    url: "/ja/blog/{県名}/living-convenience-article-1/"
  },
  {
    title: "新千歳空港からのアクセス",  // 主要空港・交通ハブ
    category: "アクセス", 
    url: "/ja/blog/{県名}/access-article-1/"
  },
  {
    title: "{市名}の住宅事情：家賃・光熱費",  // 市名でローカライズ
    category: "コスト",
    url: "/ja/blog/{県名}/cost-article-1/"
  }
];
```

### レイアウト構造
- **メインコンテンツ**: `lg:col-span-3`（左側、8カテゴリー表示）
- **サイドバー**: `lg:col-span-1`（右側、人気記事表示）
- **モバイル**: 人気記事は最下部に表示（`lg:hidden`）

---
**作成日**: 2025年1月22日  
**更新日**: 2025年7月23日  
**参考実装**: https://kasaman04.github.io/TerraScope-Japan/ja/blog/hokkaido/sapporo/ (札幌市)  
**実装済み**: 北海道全9市（パンくずリスト、人気記事セクション含む）